"use strict";(self.webpackChunkcase_study=self.webpackChunkcase_study||[]).push([[116],{5116:(M,h,n)=>{n.r(h),n.d(h,{ComprasModule:()=>z});var l=n(6895),Z=n(5823),T=n(2041),p=n(9197),I=n(5226),m=n.n(I),t=n(4650),x=n(5315),_=n(4859),u=n(3546),v=n(7392);function N(i,a){if(1&i){const o=t.EpF();t.TgZ(0,"div",3)(1,"mat-card",4)(2,"mat-card-title"),t._uU(3),t.qZA(),t.TgZ(4,"mat-card-subtitle"),t._uU(5),t.ALo(6,"currency"),t.qZA(),t.TgZ(7,"mat-card-title-group")(8,"mat-card-content"),t._UZ(9,"img",5),t.qZA(),t.TgZ(10,"mat-card-title-group")(11,"button",6),t.NdJ("click",function(){const c=t.CHM(o).$implicit,d=t.oxw();return t.KtG(d.addRemove(c.id,-1))}),t.TgZ(12,"mat-icon"),t._uU(13,"remove"),t.qZA()(),t.TgZ(14,"span",7),t._uU(15),t.qZA(),t.TgZ(16,"button",6),t.NdJ("click",function(){const c=t.CHM(o).$implicit,d=t.oxw();return t.KtG(d.addRemove(c.id,1))}),t.TgZ(17,"mat-icon"),t._uU(18,"add"),t.qZA()()(),t.TgZ(19,"button",6),t.NdJ("click",function(){const c=t.CHM(o).$implicit,d=t.oxw();return t.KtG(d.enviarCambio(c))}),t.TgZ(20,"mat-icon"),t._uU(21,"send"),t.qZA()()(),t.TgZ(22,"mat-card-actions")(23,"button",8),t.NdJ("click",function(){const c=t.CHM(o).$implicit,d=t.oxw();return t.KtG(d.editar(c))}),t.TgZ(24,"mat-icon"),t._uU(25,"edit"),t.qZA()(),t.TgZ(26,"button",9),t.NdJ("click",function(){const c=t.CHM(o).$implicit,d=t.oxw();return t.KtG(d.eliminar(c))}),t.TgZ(27,"mat-icon"),t._uU(28,"delete"),t.qZA()()()()()}if(2&i){const o=a.$implicit,e=t.oxw();t.xp6(3),t.Oqu(o.nombre),t.xp6(2),t.AsE("",o.descripcion," - ",t.lcZ(6,10,o.precio),""),t.xp6(4),t.Q6J("src",o.imagen,t.LSH),t.xp6(2),t.Q6J("disabled",o.existentes<1||e.cargando),t.xp6(4),t.Oqu(o.existentes),t.xp6(1),t.Q6J("disabled",e.cargando),t.xp6(3),t.Q6J("disabled",e.cargando),t.xp6(4),t.Q6J("disabled",e.cargando),t.xp6(3),t.Q6J("disabled",e.cargando)}}let U=(()=>{class i{constructor(o,e){this.productoService=o,this.router=e,this.productos=[],this.cargando=!1}ngOnInit(){this.productoService.listarProductos().subscribe(o=>{this.productos=o.productos})}addRemove(o,e){this.productos.forEach(r=>{r.id===o&&(r.existentes+=e)})}enviarCambio(o){this.cargando=!0,this.editExis={id:o.id,cantidad:o.existentes},this.productoService.editarExistencia(this.editExis).subscribe(e=>{e.ok?m().fire({position:"center",icon:"success",title:"Editado exitosamente",text:o.nombre,showConfirmButton:!1,imageUrl:o.imagen,imageWidth:150,imageHeight:150,timer:2e3}):m().fire("Error, ",e.mensaje,"error"),this.cargando=!1})}editar(o){this.router.navigate(["/compras/editar",o.id])}eliminar(o){this.cargando=!0,m().fire({title:"\xbfEstas seguro de eliminar este producto?",imageUrl:o.imagen,imageWidth:150,imageHeight:150,text:o.nombre,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si eliminar"}).then(e=>{e.isConfirmed&&this.productoService.eliminarProducto(o.id).subscribe(r=>{r.ok?(m().fire({position:"center",icon:"success",title:"Eliminado exitosamente",text:o.nombre+" eliminado",timer:2e3}),this.cargando=!1,this.ngOnInit()):(m().fire("Error, ",r.mensaje,"error"),this.cargando=!1,this.ngOnInit())})})}}return i.\u0275fac=function(o){return new(o||i)(t.Y36(x.k),t.Y36(p.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-listar-productos"]],decls:6,vars:1,consts:[[1,"container","justify-content-center","text-center","row","ms-5","mb-5"],[1,"mt-2"],["class","col-lg-5 col-sm-10 col-md-10 col-xs-11 animate__animated  animate__fadeIn",4,"ngFor","ngForOf"],[1,"col-lg-5","col-sm-10","col-md-10","col-xs-11","animate__animated","animate__fadeIn"],[1,"mt-4"],["mat-card-md-image","",1,"img-formato",3,"src"],["mat-button","","mat-mini-fab","","color","primary",3,"disabled","click"],[1,"me-3","ms-3"],["mat-flat-button","","color","primary",1,"me-3",3,"disabled","click"],["mat-flat-button","","color","warn",3,"disabled","click"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"Editar Productos"),t.qZA(),t._UZ(3,"br")(4,"hr"),t.YNc(5,N,29,12,"div",2),t.qZA()),2&o&&(t.xp6(5),t.Q6J("ngForOf",e.productos))},dependencies:[l.sg,_.lW,u.a8,u.C1,u.dn,u.n5,u.$j,u.hq,u.nc,v.Hw,l.H9],encapsulation:2}),i})();var s=n(4006),f=n(1576),b=n(9549),A=n(4144),P=n(3162),g=n(8997);function y(i,a){1&i&&(t.TgZ(0,"mat-icon"),t._uU(1,"edit"),t.qZA())}function F(i,a){1&i&&(t.TgZ(0,"mat-icon"),t._uU(1,"save"),t.qZA())}function J(i,a){if(1&i){const o=t.EpF();t.TgZ(0,"div",14),t._UZ(1,"img",15)(2,"br"),t.TgZ(3,"div")(4,"button",16),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.cambiar())}),t._uU(5," Cambiar imagen "),t.TgZ(6,"mat-icon"),t._uU(7,"change_circle"),t.qZA()()()()}if(2&i){const o=t.oxw();t.xp6(1),t.Q6J("src",o.producto.imagen,t.LSH),t.xp6(3),t.Q6J("disabled",o.cargando)}}function L(i,a){if(1&i){const o=t.EpF();t.TgZ(0,"ngx-dropzone-image-preview",21),t.NdJ("removed",function(){const c=t.CHM(o).$implicit,d=t.oxw(2);return t.KtG(d.quitarImagen(c))}),t.qZA()}2&i&&t.Q6J("file",a.$implicit)("removable",!0)}function q(i,a){if(1&i){const o=t.EpF();t.TgZ(0,"div",17)(1,"ngx-dropzone",18),t.NdJ("change",function(r){t.CHM(o);const c=t.oxw();return t.KtG(c.seleccionaImagen(r))}),t.TgZ(2,"ngx-dropzone-label"),t._uU(3,"Click o arrastra tu imagen "),t.TgZ(4,"mat-icon"),t._uU(5,"insert_photo"),t.qZA()(),t.YNc(6,L,1,2,"ngx-dropzone-image-preview",19),t.qZA(),t._UZ(7,"br"),t.TgZ(8,"div")(9,"button",20),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.subirImagen())}),t._uU(10," Subir foto "),t.TgZ(11,"mat-icon"),t._uU(12,"insert_photo"),t.qZA()()()()}if(2&i){const o=t.oxw();t.xp6(6),t.Q6J("ngForOf",o.files),t.xp6(3),t.Q6J("disabled",o.cargando||o.files.length<1||""!==o.idFoto)}}function w(i,a){1&i&&t._UZ(0,"mat-progress-bar",22)}let C=(()=>{class i{constructor(o,e,r,c){this.fb=o,this.prods=e,this.router=r,this.idRoute=c,this.formulario=this.fb.group({nombre:["Carameladas",[s.kI.required,s.kI.minLength(3)]],precio:[15,[s.kI.required,s.kI.min(0)]],descripcion:["Barcel",[s.kI.required,s.kI.minLength(3)]],existentes:[10,[s.kI.min(0)]]}),this.cargando=!1,this.producto={id:"",nombre:"",precio:0,descripcion:"",existentes:0,imagen:null,idImagen:null},this.files=[],this.foto="",this.idFoto="",this.cambiarImagen=!1,this.cambiarI=!1}ngOnInit(){this.idRoute.snapshot.paramMap.get("id")&&this.prods.listarUnProducto(this.idRoute.snapshot.paramMap.get("id")).subscribe(o=>{this.producto=o.producto,this.formulario.reset({nombre:this.producto.nombre,precio:this.producto.precio,descripcion:this.producto.descripcion,existentes:this.producto.existentes})})}guardar(o){this.cargando=!0,this.producto.nombre=this.formulario.value.nombre,this.producto.precio=this.formulario.value.precio,this.producto.descripcion=this.formulario.value.descripcion,this.producto.existentes=this.formulario.value.existentes,this.cambiarI&&(this.producto.imagen=this.foto,this.producto.idImagen=this.idFoto),o?this.prods.editarProducto(this.producto,o).subscribe(e=>{e.ok?(m().fire("Exito!","Producto editado con exito","success"),this.router.navigate(["/compras/listar"])):m().fire("Error, ",e.mensaje,"error"),this.cargando=!1}):this.prods.crearProducto(this.producto).subscribe(e=>{e.ok?(m().fire("Exito!","Producto creado con exito","success"),this.router.navigate(["/compras/listar"])):m().fire("Error, ",e.mensaje,"error"),this.cargando=!1})}subirImagen(){if(this.cargando=!0,this.cambiarI=!0,this.idFoto)this.cargando=!1;else{if(!this.files[0])return void(this.cargando=!1);const o=this.files[0],e=new FormData;e.append("file",o),e.append("upload_preset","g29k4pwe"),e.append("cloud_name","djxpuwlz0"),this.prods.subirImagen(e).subscribe(r=>{this.foto=r.url,this.idFoto=r.public_id,this.cargando=!1})}}seleccionaImagen(o){this.files.push(...o.addedFiles),this.files.length>1&&this.files.shift()}quitarImagen(o){this.cargando=!0,this.files.splice(this.files.indexOf(o),1),this.idFoto&&this.prods.eliminarImagen(this.idFoto).subscribe(console.log),this.foto="",this.idFoto="",this.cargando=!1,this.cambiarImagen=!1,this.cambiarI=!1}cambiar(){this.cambiarImagen=!0}cancelar(){this.router.navigate(["/compras/listar"])}}return i.\u0275fac=function(o){return new(o||i)(t.Y36(s.qu),t.Y36(x.k),t.Y36(p.F0),t.Y36(p.gz))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-nuevo-producto"]],decls:38,vars:11,consts:[[1,"container","mt-3"],["fxLayout","row","fxLayoutGap","40px",3,"formGroup"],["fxFlex","50","fxLayout","column"],["fxFlex","100"],["type","text","matInput","","required","","formControlName","nombre"],["type","text","matInput","","required","","formControlName","descripcion"],["type","number","matInput","","required","","formControlName","precio"],["type","number","matInput","","formControlName","existentes"],["fxLayoutAlign","end","fxLayoutGap","120px","fxLayoutGap.gt-md","90px","fxLayoutGap.sm","60px"],["mat-raised-button","","color","primary",3,"disabled","click"],[4,"ngIf"],["fxFlex","40","fxLayout","column",4,"ngIf"],["fxFlex","25","fxLayout","column",4,"ngIf"],["mode","indeterminate",4,"ngIf"],["fxFlex","40","fxLayout","column"],["fxFlex","60",1,"img",3,"src"],["fxFlex","65","mat-raised-button","","color","primary",3,"disabled","click"],["fxFlex","25","fxLayout","column"],["fxFlex","60",3,"change"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed",4,"ngFor","ngForOf"],["fxFlex","100","mat-raised-button","","color","primary",3,"disabled","click"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed"],["mode","indeterminate"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2),t.TgZ(3,"small"),t._uU(4),t.qZA()(),t.TgZ(5,"form",1)(6,"div",2)(7,"mat-form-field",3)(8,"mat-label"),t._uU(9,"Nombre del producto"),t.qZA(),t._UZ(10,"input",4),t.qZA(),t.TgZ(11,"mat-form-field",3)(12,"mat-label"),t._uU(13,"Descripcion"),t.qZA(),t._UZ(14,"input",5),t.qZA(),t.TgZ(15,"mat-form-field",3)(16,"mat-label"),t._uU(17,"Precio"),t.qZA(),t._UZ(18,"input",6),t.qZA(),t.TgZ(19,"mat-form-field",3)(20,"mat-label"),t._uU(21,"Cantidad"),t.qZA(),t._UZ(22,"input",7),t.qZA(),t._UZ(23,"br"),t.TgZ(24,"div",8)(25,"button",9),t.NdJ("click",function(){return e.cancelar()}),t.TgZ(26,"mat-icon"),t._uU(27,"cancel"),t.qZA(),t._uU(28," Cancelar "),t.qZA(),t.TgZ(29,"button",9),t.NdJ("click",function(){return e.guardar(e.producto.id)}),t.YNc(30,y,2,0,"mat-icon",10),t.YNc(31,F,2,0,"mat-icon",10),t._uU(32),t.qZA()()(),t.YNc(33,J,8,2,"div",11),t.YNc(34,q,13,2,"div",12),t.qZA(),t._UZ(35,"br")(36,"br"),t.YNc(37,w,1,0,"mat-progress-bar",13),t.qZA()),2&o&&(t.xp6(2),t.hij(" ",e.producto.id?"Editar":"Nuevo"," Producto "),t.xp6(2),t.Oqu(e.producto.nombre),t.xp6(1),t.Q6J("formGroup",e.formulario),t.xp6(20),t.Q6J("disabled",e.cargando),t.xp6(4),t.Q6J("disabled",e.formulario.invalid||e.cargando),t.xp6(1),t.Q6J("ngIf",e.producto.id),t.xp6(1),t.Q6J("ngIf",!e.producto.id),t.xp6(1),t.hij(" ",e.producto.id?"Actualizar":"Crear"," "),t.xp6(1),t.Q6J("ngIf",!e.cambiarImagen&&e.producto.id),t.xp6(1),t.Q6J("ngIf",e.cambiarImagen||!e.producto.id),t.xp6(3),t.Q6J("ngIf",e.cargando))},dependencies:[l.sg,l.O5,f.xw,f.SQ,f.Wh,f.yH,_.lW,b.KE,b.hX,v.Hw,A.Nt,P.pW,g._f,g.NP,g.sv,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.Q7,s.sg,s.u],styles:[".img[_ngcontent-%COMP%]{border-radius:15%;width:60%;height:80%}"]}),i})();var k=n(123);const H=[{path:"",component:(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-home"]],decls:1,vars:0,template:function(o,e){1&o&&t._UZ(0,"app-home-page")},dependencies:[k.h],encapsulation:2}),i})(),children:[{path:"listar",component:U},{path:"editar/:id",component:C},{path:"nuevo",component:C},{path:"**",redirectTo:"listar"}]}];let Q=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.Bz.forChild(H),p.Bz]}),i})();var E=n(4466);let z=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[l.ez,Q,Z.o9,T.q,E.m]}),i})()}}]);