"use strict";(self.webpackChunkcase_study=self.webpackChunkcase_study||[]).push([[195],{1195:(I,d,e)=>{e.r(d),e.d(d,{AdminModule:()=>F});var n=e(6895),c=e(9197),o=e(4650),p=e(123);let h=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=o.Xpm({type:i,selectors:[["app-home"]],decls:1,vars:0,template:function(t,a){1&t&&o._UZ(0,"app-home-page")},dependencies:[p.h],encapsulation:2}),i})();var f=e(5226),l=e.n(f),v=e(2340),g=e(4004),C=e(262),U=e(9646),A=e(529);let b=(()=>{class i{constructor(t){this.http=t,this.baseUrl=v.N.baseUrl}listarUsuario(){return this.http.get(`${this.baseUrl}/usuarios`).pipe((0,g.U)(t=>!!t.usuarios&&t),(0,C.K)(t=>(0,U.of)(t)))}activarDesactivar(t){return this.http.delete(`${this.baseUrl}/usuarios/${t}`)}editarRoles(t,a){return this.http.put(`${this.baseUrl}/usuarios/editarRoles/${a}`,t)}}return i.\u0275fac=function(t){return new(t||i)(o.LFG(A.eN))},i.\u0275prov=o.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var Z=e(7266),u=e(4006),R=e(4859),_=e(6709),T=e(7392);function O(i,s){if(1&i&&(o.TgZ(0,"li"),o._uU(1),o.qZA()),2&i){const t=s.$implicit;o.xp6(1),o.hij("- ",t,"")}}function x(i,s){if(1&i){const t=o.EpF();o.TgZ(0,"button",11),o.NdJ("click",function(){o.CHM(t);const r=o.oxw();return o.KtG(r.activarDesactivar())}),o.TgZ(1,"mat-icon"),o._uU(2,"person_off"),o.qZA()()}if(2&i){const t=o.oxw();o.Q6J("disabled",t.cargando)}}function M(i,s){if(1&i){const t=o.EpF();o.TgZ(0,"button",11),o.NdJ("click",function(){o.CHM(t);const r=o.oxw();return o.KtG(r.activarDesactivar())}),o.TgZ(1,"mat-icon"),o._uU(2,"person"),o.qZA()()}if(2&i){const t=o.oxw();o.Q6J("disabled",t.cargando)}}let N=(()=>{class i{constructor(t){this.fb=t,this.cargando=!1,this.onActiveDesactive=new o.vpe,this.onCambiarRol=new o.vpe,this.cambioRol=!1,this.roles=this.fb.group({user:!1,compras:!1,admin:!1})}ngAfterContentInit(){this.roles.reset({user:this.usuario.roles.includes("ROLE_USER"),compras:this.usuario.roles.includes("ROLE_COMPRAS"),admin:this.usuario.roles.includes("ROLE_ADMIN")}),this.roles.get("user")?.disable()}activarDesactivar(){this.onActiveDesactive.emit(this.usuario.id)}enviarNuevoRol(){this.roles.get("compras")?.value&&!this.usuario.roles.includes("ROLE_COMPRAS")&&this.usuario.roles.push("ROLE_COMPRAS"),!this.roles.get("compras")?.value&&this.usuario.roles.includes("ROLE_COMPRAS")&&(this.usuario.roles=this.usuario.roles.filter(t=>"ROLE_COMPRAS"!==t)),this.roles.get("admin")?.value&&!this.usuario.roles.includes("ROLE_ADMIN")&&this.usuario.roles.push("ROLE_ADMIN"),!this.roles.get("admin")?.value&&this.usuario.roles.includes("ROLE_ADMIN")&&(this.usuario.roles=this.usuario.roles.filter(t=>"ROLE_ADMIN"!==t)),this.onCambiarRol.emit(this.usuario)}editarRol(){this.cambioRol=!0}}return i.\u0275fac=function(t){return new(t||i)(o.Y36(u.qu))},i.\u0275cmp=o.Xpm({type:i,selectors:[["app-usuario-card"]],inputs:{usuario:"usuario",cargando:"cargando"},outputs:{onActiveDesactive:"onActiveDesactive",onCambiarRol:"onCambiarRol"},decls:43,vars:14,consts:[[1,"img-edit","justify-content-center","row","bg-dark"],[1,"col-6"],[1,"img-fluid","img-users",3,"src"],[4,"ngFor","ngForOf"],[1,"example-section",3,"formGroup"],["formControlName","user"],["formControlName","compras",3,"click"],["formControlName","admin",3,"click"],["mat-raised-button","","color","accent",1,"mt-3",3,"disabled","click"],[1,"mt-4"],["mat-fab","","color","accent",3,"disabled","click",4,"ngIf"],["mat-fab","","color","accent",3,"disabled","click"]],template:function(t,a){1&t&&(o.TgZ(0,"div",0)(1,"div",1)(2,"h1"),o._uU(3),o.qZA(),o._UZ(4,"hr"),o.TgZ(5,"h3"),o._uU(6),o.qZA(),o._UZ(7,"img",2),o.TgZ(8,"ul")(9,"li"),o._uU(10),o.qZA(),o.TgZ(11,"li"),o._uU(12),o.ALo(13,"date"),o.qZA(),o.TgZ(14,"li"),o._uU(15),o.qZA(),o.TgZ(16,"span"),o._uU(17,"Roles:"),o.qZA(),o.YNc(18,O,2,1,"li",3),o.qZA()(),o.TgZ(19,"div",1)(20,"h1"),o._uU(21,"editar"),o.qZA(),o._UZ(22,"hr"),o.TgZ(23,"h4"),o._uU(24,"Roles"),o.qZA(),o.TgZ(25,"section",4)(26,"div")(27,"mat-checkbox",5),o._uU(28,"USER"),o.qZA()(),o.TgZ(29,"div")(30,"mat-checkbox",6),o.NdJ("click",function(){return a.editarRol()}),o._uU(31,"COMPRAS"),o.qZA()(),o.TgZ(32,"div")(33,"mat-checkbox",7),o.NdJ("click",function(){return a.editarRol()}),o._uU(34,"ADMIN"),o.qZA()()(),o.TgZ(35,"button",8),o.NdJ("click",function(){return a.enviarNuevoRol()}),o._uU(36,"Enviar roles"),o.qZA(),o.TgZ(37,"div")(38,"label",9),o._uU(39),o.qZA(),o._UZ(40,"br"),o.YNc(41,x,3,1,"button",10),o.YNc(42,M,3,1,"button",10),o.qZA()()()),2&t&&(o.xp6(3),o.Oqu(a.usuario.name),o.xp6(3),o.hij("Usuario: ",a.usuario.username,""),o.xp6(1),o.Q6J("src",a.usuario.image,o.LSH),o.xp6(3),o.hij("Correo: ",a.usuario.email,""),o.xp6(2),o.hij("Creado: ",o.lcZ(13,12,a.usuario.createAt),""),o.xp6(3),o.hij("\xbfActivo?: ",a.usuario.enabled?"Si":"No",""),o.xp6(3),o.Q6J("ngForOf",a.usuario.roles),o.xp6(7),o.Q6J("formGroup",a.roles),o.xp6(10),o.Q6J("disabled",!a.cambioRol||a.cargando),o.xp6(4),o.hij(" ",a.usuario.enabled?"Desactivar":"Activar"," "),o.xp6(2),o.Q6J("ngIf",a.usuario.enabled),o.xp6(1),o.Q6J("ngIf",!a.usuario.enabled))},dependencies:[n.sg,n.O5,R.lW,_.oG,T.Hw,u.JJ,u.JL,u.sg,u.u,n.uU],styles:[".example-section[_ngcontent-%COMP%]{margin:0}"]}),i})();function D(i,s){if(1&i){const t=o.EpF();o.TgZ(0,"div",3)(1,"app-usuario-card",4),o.NdJ("onActiveDesactive",function(r){o.CHM(t);const m=o.oxw();return o.KtG(m.activarDesactivarUsuario(r))})("onCambiarRol",function(r){o.CHM(t);const m=o.oxw();return o.KtG(m.cambiarRol(r))}),o.qZA()()}if(2&i){const t=s.$implicit,a=o.oxw();o.xp6(1),o.Q6J("cargando",a.cargando)("usuario",t)}}const J=[{path:"",component:h,children:[{path:"usuarios",component:(()=>{class i{constructor(t,a,r){this.adminService=t,this.authService=a,this.router=r,this.usuarios=[],this.cargando=!1}get usuario(){return this.authService.usuario}ngOnInit(){this.adminService.listarUsuario().subscribe(t=>{t.ok?(this.usuarios=t.usuarios,this.usuarios=this.usuarios.filter(a=>a.id!==this.usuario.id)):(l().fire("Opss!","Algo salio mal al cargar los usuarios","error"),this.router.navigateByUrl("/productos"))})}activarDesactivarUsuario(t){this.cargando=!0,this.adminService.activarDesactivar(t).subscribe(a=>{a.ok||l().fire("Opss!",a.msg,"error"),this.cargando=!1,this.ngOnInit()})}cambiarRol(t){this.cargando=!0,this.adminService.editarRoles(t,t.id).subscribe(a=>{a.ok||l().fire("Opss!",a.error,"error"),this.cargando=!1,this.ngOnInit()})}}return i.\u0275fac=function(t){return new(t||i)(o.Y36(b),o.Y36(Z.e),o.Y36(c.F0))},i.\u0275cmp=o.Xpm({type:i,selectors:[["app-usuarios"]],decls:6,vars:1,consts:[[1,"container","justify-content-center","text-center","row","ms-5","mb-5"],[1,"mt-2"],["class","col-lg-5 col-md-10 col-sm-10 me-2 col-xs-11 container mb-3 animate__animated  animate__fadeIn",4,"ngFor","ngForOf"],[1,"col-lg-5","col-md-10","col-sm-10","me-2","col-xs-11","container","mb-3","animate__animated","animate__fadeIn"],[3,"cargando","usuario","onActiveDesactive","onCambiarRol"]],template:function(t,a){1&t&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"Editar Usuarios"),o.qZA(),o._UZ(3,"br")(4,"hr"),o.YNc(5,D,2,2,"div",2),o.qZA()),2&t&&(o.xp6(5),o.Q6J("ngForOf",a.usuarios))},dependencies:[n.sg,N],encapsulation:2}),i})()},{path:"**",redirectTo:"usuarios"}]}];let S=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({imports:[c.Bz.forChild(J),c.Bz]}),i})();var E=e(2041),y=e(4466);let F=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({imports:[n.ez,S,E.q,y.m]}),i})()}}]);